"use strict";(self["webpackChunkel_admin_v2"]=self["webpackChunkel_admin_v2"]||[]).push([[458,704,913],{5970:function(e,t,s){s.d(t,{Z:function(){return c}});var i,a,l={methods:{refreshUserData(e){this.$http.get("/service/loginData/refreshUserData",{params:{language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us",refreshDataType:e}}).then((t=>{if(0===t.code){let s=[];switch(e){case"events":break;case"datas":this.$store.commit("common/updateDictList",t.data);break;case"privileges":this.$store.commit("common/updatePermissions",t.data);break;case"menus":this.$router.options.hasAddDynamicMenuRoutes=!1,console.log(this.$router.options.hasAddDynamicMenuRoutes),this.$store.commit("common/updateAllMenuList",t.data),s=this.$store.getters["common/menuRoutersList"].map((e=>{const t=e.urlVue.startsWith("/")?e.urlVue:`/${e.urlVue}`;return{path:t,meta:{nameEnUs:e.nameEnUs,nameLocal:e.nameLocal},component:null}})),this.$store.commit("common/updateBusiRouters",[...s]);break;case"languages":this.$i18n.mergeLocaleMessage("zh",t.data.languages);break}}}))}},filters:{},watch:{}},o=l,r=s(3736),n=(0,r.Z)(o,i,a,!1,null,null,null),c=n.exports},9704:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.dataForm.id?"编辑":"新增",visible:e.visible},on:{"update:visible":function(t){e.visible=t},close:e.resetDataForm}},[t("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"150px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[t("el-form-item",{attrs:{label:e.$t("角色名称"),prop:"roleName"}},[t("el-input",{attrs:{maxlength:25},model:{value:e.dataForm.roleName,callback:function(t){e.$set(e.dataForm,"roleName",t)},expression:"dataForm.roleName"}})],1),t("el-form-item",{attrs:{label:e.$t("级别"),prop:"roleLevel"}},[t("el-select",{attrs:{size:"mini"},model:{value:e.dataForm.roleLevel,callback:function(t){e.$set(e.dataForm,"roleLevel",t)},expression:"dataForm.roleLevel"}},e._l(e.levelList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),t("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},a=[],l={components:{},mixins:[],props:{},data(){return{visible:!1,fullscreenLoading:!1,levelList:[],clickStatu:!1,dataForm:{id:"",roleName:"",roleLevel:"0"},dataRule:{roleName:[{required:!0,message:this.$t("sys.role.roleName")+this.$t("info.common.notNull "),trigger:"blur"}]}}},computed:{},created(){},mounted(){this.levelList=this.$store.getters["getDictList"]("user.level")},methods:{init(e){this.visible=!0,console.log(e),console.log(this.dataForm),this.$nextTick((()=>{this.$refs.dataForm.resetFields(),e&&(this.dataForm=e||"")}))},resetDataForm(){this.dataForm={id:"",roleName:"",roleLevel:"0"}},dataFormSubmit(){this.clickStatu||(this.clickStatu=!0,this.$refs["dataForm"].validate((e=>{if(e){this.fullscreenLoading=!0;let e={};e={id:this.dataForm.id||null,roleName:this.dataForm.roleName,roleLevel:this.dataForm.roleLevel,language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us"},this.$http({url:"/service/role/save",method:"post",data:e,contentType:"json"}).then((e=>{console.log(e),e&&0===e.code?(this.visible=!1,this.$emit("refreshDataList"),this.$message({message:this.$t("operateSuccess"),type:"success",duration:1500,onClose:()=>{this.clickStatu=!1,this.fullscreenLoading=!1}})):this.$message({message:this.$t(e.msg),type:"error",duration:1500,onClose:()=>{this.clickStatu=!1,this.fullscreenLoading=!1}})}))}}))),setTimeout((()=>{this.clickStatu=!1,this.fullscreenLoading=!1}),1500)}},filters:{},watch:{}},o=l,r=s(3736),n=(0,r.Z)(o,i,a,!1,null,"7242500c",null),c=n.exports},9913:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:this.$t("window.select"),visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[t("el-tree",{ref:"tree",staticClass:"el-dialog-div",attrs:{data:e.menuList,props:e.defaultProps,"show-checkbox":"","auto-expand-parent":"","default-expanded-keys":e.ids,nodeKey:"id"},on:{"check-change":e.handleNodeChange}}),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),t("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},a=[],l=s(5970),o={components:{},mixins:[l.Z],props:{},data(){return{visible:!1,fullscreenLoading:!1,clickStatu:!1,parentName:"",menuList:[],id:"",ids:[],priviArray:[],defaultProps:{children:"children",label:"name"}}},computed:{},created(){},mounted(){},methods:{init(e){this.visible=!0,this.id=e,this.ids=[],this.priviArray=[],this.getRolePriviTree(e)},getRolePriviTree(e){let t={};t={language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us",id:e},this.$http({url:"/role",method:"post",data:t,contentType:"json"}).then((e=>{0===e.code?(this.menuList=e.data,this.nestToSimple(this.menuList),this.$nextTick((()=>{this.$refs.tree.setCheckedKeys(this.ids)}))):this.$message(this.$t(e.msg))}))},nestToSimple(e){e.forEach((e=>{1===e.state&&this.ids.push(e.id),e.children&&e.children.length>0&&this.nestToSimple(e.children)}))},handleNodeChange(){this.$nextTick((()=>{this.priviArray=this.$refs.tree.getCheckedKeys()}))},dataFormSubmit(){if(!this.clickStatu){this.clickStatu=!0,this.fullscreenLoading=!0;let e={};e={id:this.id,priviArray:this.priviArray,language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us"},this.$http({url:"/service/role",method:"post",data:e,contentType:"json"}).then((e=>{console.log(e),e&&0===e.code?(this.refreshUserData("privileges"),this.visible=!1,this.$emit("refreshDataList"),this.$message({message:this.$t("operateSuccess"),type:"success",duration:1500,onClose:()=>{this.clickStatu=!1,this.fullscreenLoading=!1}})):this.$message({message:this.$t(e.msg),type:"error",duration:1500,onClose:()=>{this.clickStatu=!1,this.fullscreenLoading=!1}})}))}setTimeout((()=>{this.clickStatu=!1,this.fullscreenLoading=!1}),1500)}},filters:{},watch:{}},r=o,n=s(3736),c=(0,n.Z)(r,i,a,!1,null,"32670322",null),d=c.exports},8458:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"RoleList"}},[t("grid",{ref:"role",attrs:{api:e.api,model:e.dataForm,columns:e.columns,method:"post",requestOption:{contentType:"json"},rowKey:"id",multiSelectedArr:e.multipleSelection,requestCallback:e.requestCallback},on:{"update:multiSelectedArr":function(t){e.multipleSelection=t},"update:multi-selected-arr":function(t){e.multipleSelection=t}}},[t("div",{attrs:{slot:"form"},slot:"form"},[t("el-form-item",{attrs:{label:this.$t("角色名称")}},[t("el-input",{attrs:{placeholder:this.$t("角色名称"),clearable:""},model:{value:e.dataForm.roleName,callback:function(t){e.$set(e.dataForm,"roleName",t)},expression:"dataForm.roleName"}})],1)],1),t("btn-list",{attrs:{slot:"toolbar",data:e.btnList},on:{click:e.action},slot:"toolbar"})],1),e.addOrUpdateVisible?t("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.refresh}}):e._e(),e.distributeVisible?t("distribute",{ref:"distribute"}):e._e()],1)},a=[],l=s(9704),o=s(9913),r={name:"RoleList",components:{AddOrUpdate:l["default"],Distribute:o["default"]},mixins:[],props:{},data(){this.$createElement;return{api:"/list/5",addOrUpdateVisible:!1,distributeVisible:!1,multipleSelection:[],dataForm:{roleName:""},columns:[{type:"selection",align:"center",width:"50"},{label:"角色名称",prop:"roleName",align:"center"},{label:"级别",prop:"roleLevel",align:"center",render(e,{row:t}){const s=e("span",[this.$store.getters["getDictName"]("user.level",t.roleLevel)]);return[s]}}]}},computed:{btnList(){return this.$store.getters.getPermissionsByCode("management.role")}},created(){},mounted(){},methods:{action(e){const t=!(!e||!this[e]);t?this[e]():this.$message("该功能暂未支持,请联系管理员确认配置是否出错！")},add(){this.addOrUpdateVisible=!0,this.$nextTick((()=>{this.$refs.addOrUpdate.init()}))},edit(){if(0===this.multipleSelection.length)this.$message({message:this.$t("info.common.selectmore"),type:"warning",duration:1500});else if(1===this.multipleSelection.length){this.addOrUpdateVisible=!0;let e={};this.$refs.role.list.forEach((t=>{t.id===this.multipleSelection[0].id&&(e=JSON.parse(JSON.stringify(t)))})),console.log(e),this.$nextTick((()=>{this.$refs.addOrUpdate.init(e)}))}else this.$message({message:this.$t("info.common.selectone"),type:"warning",duration:1500})},copy(){if(0===this.multipleSelection.length)this.$message({message:this.$t("info.common.selectmore"),type:"warning",duration:1500});else if(1===this.multipleSelection.length){this.addOrUpdateVisible=!0;let e={};this.$refs.role.list.forEach((t=>{t.id===this.multipleSelection[0].id&&(e=JSON.parse(JSON.stringify(t)))})),console.log(e),this.$nextTick((()=>{this.$refs.addOrUpdate.init(e,"type")}))}else this.$message({message:this.$t("info.common.selectone"),type:"warning",duration:1500})},exportData(){},assign(){0===this.multipleSelection.length?this.$message({message:this.$t("info.common.selectmore"),type:"warning",duration:1500}):1===this.multipleSelection.length?(this.distributeVisible=!0,this.$nextTick((()=>{this.$refs.distribute.init(this.multipleSelection[0].id)}))):this.$message({message:this.$t("info.common.selectone"),type:"warning",duration:1500})},refresh(){this.$refs.role.getDataList()},del(e){var t=e?[e]:this.multipleSelection.map((e=>e.id));let s={};s={ids:t,language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us"},this.$confirm(this.$t("info.common.delete"),this.$t("提示")).then((()=>{this.$http({url:"/service/role/del",method:"post",data:s,contentType:"json"}).then((e=>{e&&0===e.code?(this.refresh(),this.$message({message:this.$t("info.common.deletesuccess"),type:"success",duration:1500,onClose:()=>{}})):this.$message.error(this.$t(e.msg))}))}))},requestCallback(e,t){t&&0===t.code&&(e.list=t.data.result,e.totalCount=t.data.totalCount)}},filters:{},watch:{}},n=r,c=s(3736),d=(0,c.Z)(n,i,a,!1,null,"30926585",null),u=d.exports}}]);
//# sourceMappingURL=458.3c7946bd.js.map