"use strict";(self["webpackChunkel_admin_v2"]=self["webpackChunkel_admin_v2"]||[]).push([[913],{5970:function(e,t,s){s.d(t,{Z:function(){return h}});var i,a,n={methods:{refreshUserData(e){this.$http.get("/service/loginData/refreshUserData",{params:{language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us",refreshDataType:e}}).then((t=>{if(0===t.code){let s=[];switch(e){case"events":break;case"datas":this.$store.commit("common/updateDictList",t.data);break;case"privileges":this.$store.commit("common/updatePermissions",t.data);break;case"menus":this.$router.options.hasAddDynamicMenuRoutes=!1,console.log(this.$router.options.hasAddDynamicMenuRoutes),this.$store.commit("common/updateAllMenuList",t.data),s=this.$store.getters["common/menuRoutersList"].map((e=>{const t=e.urlVue.startsWith("/")?e.urlVue:`/${e.urlVue}`;return{path:t,meta:{nameEnUs:e.nameEnUs,nameLocal:e.nameLocal},component:null}})),this.$store.commit("common/updateBusiRouters",[...s]);break;case"languages":this.$i18n.mergeLocaleMessage("zh",t.data.languages);break}}}))}},filters:{},watch:{}},r=n,o=s(3736),l=(0,o.Z)(r,i,a,!1,null,null,null),h=l.exports},9913:function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:this.$t("window.select"),visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[t("el-tree",{ref:"tree",staticClass:"el-dialog-div",attrs:{data:e.menuList,props:e.defaultProps,"show-checkbox":"","auto-expand-parent":"","default-expanded-keys":e.ids,nodeKey:"id"},on:{"check-change":e.handleNodeChange}}),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),t("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},a=[],n=s(5970),r={components:{},mixins:[n.Z],props:{},data(){return{visible:!1,fullscreenLoading:!1,clickStatu:!1,parentName:"",menuList:[],id:"",ids:[],priviArray:[],defaultProps:{children:"children",label:"name"}}},computed:{},created(){},mounted(){},methods:{init(e){this.visible=!0,this.id=e,this.ids=[],this.priviArray=[],this.getRolePriviTree(e)},getRolePriviTree(e){let t={};t={language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us",id:e},this.$http({url:"/role",method:"post",data:t,contentType:"json"}).then((e=>{0===e.code?(this.menuList=e.data,this.nestToSimple(this.menuList),this.$nextTick((()=>{this.$refs.tree.setCheckedKeys(this.ids)}))):this.$message(this.$t(e.msg))}))},nestToSimple(e){e.forEach((e=>{1===e.state&&this.ids.push(e.id),e.children&&e.children.length>0&&this.nestToSimple(e.children)}))},handleNodeChange(){this.$nextTick((()=>{this.priviArray=this.$refs.tree.getCheckedKeys()}))},dataFormSubmit(){if(!this.clickStatu){this.clickStatu=!0,this.fullscreenLoading=!0;let e={};e={id:this.id,priviArray:this.priviArray,language:"zh"===this.$store.state.i18n.locale?"zh_CN":"en_us"},this.$http({url:"/service/role",method:"post",data:e,contentType:"json"}).then((e=>{console.log(e),e&&0===e.code?(this.refreshUserData("privileges"),this.visible=!1,this.$emit("refreshDataList"),this.$message({message:this.$t("operateSuccess"),type:"success",duration:1500,onClose:()=>{this.clickStatu=!1,this.fullscreenLoading=!1}})):this.$message({message:this.$t(e.msg),type:"error",duration:1500,onClose:()=>{this.clickStatu=!1,this.fullscreenLoading=!1}})}))}setTimeout((()=>{this.clickStatu=!1,this.fullscreenLoading=!1}),1500)}},filters:{},watch:{}},o=r,l=s(3736),h=(0,l.Z)(o,i,a,!1,null,"32670322",null),c=h.exports}}]);
//# sourceMappingURL=913.030e936b.js.map